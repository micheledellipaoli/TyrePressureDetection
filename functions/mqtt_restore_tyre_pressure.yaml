metadata:
  name: mqtt_restore_tyre_pressure
  labels:
    nuclio.io/project-name: 7f15a68a-45e2-4006-a7cf-f5ec6148febd
spec:
  description: "Function to generate an event on the MQTT queue sending a standard tyre pressure value."
  handler: "main:handler"
  runtime: nodejs
  resources: {}
  image: "nuclio/processor-mqtt_restore_tyre_pressure:latest"
  minReplicas: 1
  maxReplicas: 1
  targetCPU: 75
  build:
    functionSourceCode: dmFyIG1xdHQgPSByZXF1aXJlKCdtcXR0JyksIHVybCA9IHJlcXVpcmUoJ3VybCcpOwp2YXIgbXF0dF91cmwgPSB1cmwucGFyc2UocHJvY2Vzcy5lbnYuQ0xPVURBTVFQX01RVFRfVVJMIHx8ICdtcXR0Oi8vZ3Vlc3Q6Z3Vlc3RAMTcyLjI0LjIzLjUzOjE4ODMnKTsKdmFyIGF1dGggPSAobXF0dF91cmwuYXV0aCB8fCAnOicpLnNwbGl0KCc6Jyk7CnZhciB1cmwgPSAibXF0dDovLyIgKyBtcXR0X3VybC5ob3N0OwoKdmFyIG9wdGlvbnMgPSB7Cglwb3J0OiBtcXR0X3VybC5wb3J0LAoJY2xpZW50SWQ6ICdtcXR0anNfJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnN1YnN0cigyLCA4KSwKCXVzZXJuYW1lOiBhdXRoWzBdLAoJcGFzc3dvcmQ6IGF1dGhbMV0sCn07CgovKgp2YXIgc3RhbmRhcmRQcmVzc3VyZSA9IDMwMDA7CnZhciBtaW5EZWx0YVByZXNzdXJlID0gMTA7CnZhciBtYXhEZWx0YVByZXNzdXJlID0gMTAwOwoqLwp2YXIgc3RhbmRhcmRQcmVzc3VyZSA9IDMyOwp2YXIgbWluRGVsdGFQcmVzc3VyZSA9IDI7CnZhciBtYXhEZWx0YVByZXNzdXJlID0gNTsKCmZ1bmN0aW9uIGdlbmVyYXRlUmFuZG9tUHJlc3N1cmUoKXsKCXZhciB5ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihtYXhEZWx0YVByZXNzdXJlLW1pbkRlbHRhUHJlc3N1cmUpKSttaW5EZWx0YVByZXNzdXJlOwoJdmFyIHByZXNzdXJlID0gc3RhbmRhcmRQcmVzc3VyZSArIHk7Cgl2YXIgdGltZXN0YW1wID0gbmV3IERhdGUoKTsKCXJldHVybiBwcmVzc3VyZS50b1N0cmluZygpICsgIi0iICsgdGltZXN0YW1wLnRvU3RyaW5nKCk7Cn0KCgpleHBvcnRzLmhhbmRsZXIgPSBmdW5jdGlvbihjb250ZXh0LCBldmVudCkgewoJdmFyIGNsaWVudCA9IG1xdHQuY29ubmVjdCh1cmwsIG9wdGlvbnMpOwogICAgdmFyIGRhdGEgPSBnZW5lcmF0ZVJhbmRvbVByZXNzdXJlKCkudG9TdHJpbmcoKTsKCWNsaWVudC5vbignY29ubmVjdCcsIGZ1bmN0aW9uKCkgewoJCWNsaWVudC5wdWJsaXNoKCdpb3QvdHlyZS9wcmVzc3VyZScsIGRhdGEudG9TdHJpbmcoKSwgZnVuY3Rpb24oKSB7CgkJCWNsaWVudC5lbmQoKTsKCQkJY29udGV4dC5jYWxsYmFjaygnTVFUVCBNZXNzYWdlIFNlbnQgLSBUeXJlIFByZXNzdXJlIFJlc3RvcmVkOiAnK2RhdGEudG9TdHJpbmcoKSk7CgkJfSk7Cgl9KTsKfTs=
    commands:
      - 'npm install mqtt'
    runtimeAttributes:
      repositories: []
    codeEntryType: sourceCode
  platform: {}
  readinessTimeoutSeconds: 60
  version: 1
