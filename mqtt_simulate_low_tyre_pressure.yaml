metadata:
  name: mqtt_simulate_low_tyre_pressure
  labels:
    nuclio.io/project-name: 7f15a68a-45e2-4006-a7cf-f5ec6148febd
spec:
  description: "Function that generates an event on the MQTT queue, by sending a tyre pressure value minor than the standard one."
  handler: "main:handler"
  runtime: nodejs
  resources: {}
  image: "nuclio/processor-mqtt_simulate_low_tyre_pressure:latest"
  minReplicas: 1
  maxReplicas: 1
  targetCPU: 75
  build:
    image: ""
    noCache: false
    offline: false
    dependencies: []
    runtimeAttributes:
      repositories: []
    functionSourceCode: dmFyIG1xdHQgPSByZXF1aXJlKCdtcXR0JyksIHVybCA9IHJlcXVpcmUoJ3VybCcpOwp2YXIgbXF0dF91cmwgPSB1cmwucGFyc2UocHJvY2Vzcy5lbnYuQ0xPVURBTVFQX01RVFRfVVJMIHx8ICdtcXR0Oi8vZ3Vlc3Q6Z3Vlc3RAMTcyLjIyLjgzLjY3OjE4ODMnKTsKdmFyIGF1dGggPSAobXF0dF91cmwuYXV0aCB8fCAnOicpLnNwbGl0KCc6Jyk7CnZhciB1cmwgPSAibXF0dDovLyIgKyBtcXR0X3VybC5ob3N0OwoKdmFyIG9wdGlvbnMgPSB7Cglwb3J0OiBtcXR0X3VybC5wb3J0LAoJY2xpZW50SWQ6ICdtcXR0anNfJyArIE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMTYpLnN1YnN0cigyLCA4KSwKCXVzZXJuYW1lOiBhdXRoWzBdLAoJcGFzc3dvcmQ6IGF1dGhbMV0sCn07Cgp2YXIgc3RhbmRhcmRQcmVzc3VyZSA9IDMwMDA7CnZhciBtaW5EZWx0YVByZXNzdXJlID0gMTA7CnZhciBtYXhEZWx0YVByZXNzdXJlID0gNjAwOwoKZnVuY3Rpb24gZ2VuZXJhdGVSYW5kb21QcmVzc3VyZShjYWxsYmFjayl7Cgl2YXIgeSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSoobWF4RGVsdGFQcmVzc3VyZS1taW5EZWx0YVByZXNzdXJlKSkrbWluRGVsdGFQcmVzc3VyZTsKCXZhciBwcmVzc3VyZSA9IHN0YW5kYXJkUHJlc3N1cmUteTsKCXZhciB0aW1lc3RhbXAgPSBuZXcgRGF0ZSgpOwogICAgdmFyIHJlc3VsdCA9IHByZXNzdXJlLnRvU3RyaW5nKCkgKyAiLSIgKyB0aW1lc3RhbXAudG9TdHJpbmcoKTsKCQogICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0KTsgCn0KCmZ1bmN0aW9uIGluc2VydERhdGEoZXJyLCBkYXRhLCBjYWxsYmFjayl7CiAgICBpZiAoZXJyKSB0aHJvdyBlcnI7CiAgICAKICAgIHZhciBjbGllbnQgPSBtcXR0LmNvbm5lY3QodXJsLCBvcHRpb25zKTsgICAgICAgICAgICAKCWNsaWVudC5vbignY29ubmVjdCcsIGZ1bmN0aW9uKCkgeyAgICAKCSAgICBjbGllbnQucHVibGlzaCgnaW90L3R5cmUvcHJlc3N1cmUnLCBkYXRhLnRvU3RyaW5nKCksIGZ1bmN0aW9uKCkgewogICAgICAgICAgICBjbGllbnQuZW5kKCk7CiAgICAgICAgICAgIGNhbGxiYWNrKCdNUVRUIE1lc3NhZ2UgU2VudCAtIExvdyBUeXJlIFByZXNzdXJlOiAnICsgZGF0YS50b1N0cmluZygpKTsKCQl9KTsKICAgIH0pOwp9CgpleHBvcnRzLmhhbmRsZXIgPSBmdW5jdGlvbihjb250ZXh0LCBldmVudCkgewogICAgZ2VuZXJhdGVSYW5kb21QcmVzc3VyZShmdW5jdGlvbihlcnIsIGRhdGEpewogICAgICAgIGluc2VydERhdGEobnVsbCwgZGF0YSwgZnVuY3Rpb24oZGF0YSl7CiAgICAgICAgICAgIGNvbnRleHQuY2FsbGJhY2soZGF0YSk7CiAgICAgICAgfSk7CiAgICB9KTsKfTs=
    commands:
      - 'npm install mqtt'
    codeEntryType: sourceCode
  platform: {}
  readinessTimeoutSeconds: 60
